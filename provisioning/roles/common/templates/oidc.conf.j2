#!upstart
description "MitreID Connect"
author      "Josh Mandel"

start on runlevel [2345]
stop on runlevel [!2345]

respawn
respawn limit 10 5

script
    chdir {{install_dir}}
    java \
       -DBASE_URL="{{auth_server.public.base}}" \
       -DCONTEXT_FHIR_ENDPOINT="{{fhir_server.public.base}}"\
       -DCONTEXT_RESOLVE_ENDPOINT="{{app_server.public.base}}"\
       -Dldap.server="{{ldap_server.uri}}" \
       -Dldap.url="{{ldap_server.uri}}" \
       -Dldap.base="ou=People,{{ldap_server.base}}" \
       -jar jetty-runner.jar --host localhost --port 4000 \
       {{auth_server.war}}
end script
